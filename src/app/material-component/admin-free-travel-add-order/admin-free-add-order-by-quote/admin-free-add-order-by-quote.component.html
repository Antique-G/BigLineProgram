<div fxLayoutWrap="wrap">
    <div fxFlex.gt-sm="100%" fxFlex="100">

        <div class="example-container">
            <div fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="20px">
                <div fxLayout="row" fxLayoutGap="20px">
                    <button mat-raised-button color="primary" style="letter-spacing: 2px;" routerLink="/admin/main/addFreeOrder">返回自由行添加订单列表</button>
                </div>

                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">产品基本信息</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div style="padding:10px 10px" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                <div>
                                    <div style="margin-top: 5px;">
                                        <h5 style="font-weight: bold;">{{detailModel?.title}}</h5>
                                        <h6 style="font-weight: bold;">{{detailModel?.sub_title}}</h6>
                                    </div>
                                    <div style="margin-top:13px">
                                        <form nz-form nz-row [formGroup]="addForm">
                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="6" [nzXs]="24">产品id</nz-form-label>
                                                    <nz-form-control [nzSm]="8" [nzXs]="24">
                                                        <input nz-input formControlName="product_id" nzBorderless [ngModel]="detailModel?.id" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>

                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="6" [nzXs]="24">出发城市</nz-form-label>
                                                    <nz-form-control [nzSm]="8" [nzXs]="24">
                                                        <input nz-input nzBorderless formControlName="departure_city_name" [ngModel]="detailModel?.departure" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>

                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="6" [nzXs]="24">目的城市</nz-form-label>
                                                    <nz-form-control [nzSm]="8" [nzXs]="24">
                                                        <input nz-input nzBorderless formControlName="destination_city_name" [ngModel]="detailModel?.destination" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>


                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="6" [nzXs]="24">行程天数</nz-form-label>
                                                    <nz-form-control [nzSm]="8" [nzXs]="24">
                                                        <input nz-input formControlName="isDay" nzBorderless [ngModel]="isDay" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </mat-card>

                <div></div>


                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">出行信息</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div style="padding:10px 10px" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                <div>
                                    <p style="color: red;">*请选择出发日期</p>
                                    <div style="display: flex; align-items: center;">
                                        年
                                        <nz-select [(ngModel)]="selectedYear" nzPlaceHolder="Choose" (ngModelChange)="ngYearChange($event)" style="margin: 0 5px;width: 100px;">
                                            <nz-option *ngFor="let option of yearList" [nzValue]="option" [nzLabel]="option"></nz-option>
                                        </nz-select>
                                        <span style="margin-right: 5px;">月</span>
                                        <nz-pagination [nzPageIndex]="nzPageIndex" [nzPageSize]="1" [nzTotal]="12" (nzPageIndexChange)="nzPageIndexChange($event)"></nz-pagination>
                                    </div>
                                    <div class="mat-elevation-z8">
                                        <nz-calendar [(ngModel)]="selectedDateValue" (nzSelectChange)="selectChange($event)">
                                            <div *nzDateCell="let date" class="events">
                                                <ng-container *ngFor="let item of listDataMap">
                                                    <ng-container *ngIf="(date | date:'yyyy-MM-dd')==item.date">
                                                        <div style="position: absolute;top: 5px;">
                                                            <label nz-checkbox [(ngModel)]="item.checked" (ngModelChange)="changeId(item)"></label>
                                                        </div>

                                                        <div class="item itemFree" [class]="item.check_status==2?'item-bg-success': item.check_status==3?'item-bg-error':''">
                                                            <div>使用人数: <span style="color: red;">{{detailModel?.use_num}}人</span></div>
                                                            <div>价格:
                                                                <span style="color: red;">¥{{item.inclusive_price}}</span>
                                                            </div>
                                                            <div>库存: <span style="color: red;">
                                                            <span *ngIf="item.inventory_num===0||item.inventory_num===1">-</span>
                                                                <span *ngIf="item.inventory_num!=0&&item.inventory_num!=1">{{item.inventory_num}}</span>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </ng-container>

                                                </ng-container>
                                            </div>
                                        </nz-calendar>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-card>

                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">套餐信息</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div style="padding:10px 10px" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                <p style="color: red;">*请选择份数</p>
                                <div>
                                    <form nz-form nz-row [formGroup]="contactForm">
                                        <nz-form-item nz-col [nzSm]="24" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="2" [nzXs]="24">每份套餐使用人数</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="use_num" nzBorderless [ngModel]="detailModel?.use_num+'人'" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>
                                        <nz-form-item nz-col [nzSm]="24" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="2" [nzXs]="24">套餐包含</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="inclusive" nzBorderless [ngModel]="detailModel?.inclusive" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>
                                        <nz-form-item nz-col [nzSm]="24" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="2" [nzXs]="24" nzFor="num_total" nzRequired>请填写套餐份数</nz-form-label>
                                                <nz-form-control [nzSm]="12 " [nzXs]="24" nzErrorTip="请填写套餐份数">
                                                    <nz-input-number formControlName="num_total" [nzMin]="1" (ngModelChange)="onEnterPack($event)"></nz-input-number>
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-card>


                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">联系人基本信息</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div style="padding:10px 10px" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                <div>
                                    <form nz-form nz-row [formGroup]="contactForm">
                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>联系人姓名</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24" nzErrorTip="请输入联系人姓名">
                                                    <input nz-input formControlName="contact_name" [ngModel]="isName" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>

                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>联系人电话</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24" nzErrorTip="请输入联系人电话">
                                                    <input nz-input formControlName="contact_phone" [ngModel]="isPhone" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>

                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="6" [nzXs]="24">联系人微信</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="contact_wechat" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>

                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="6" [nzXs]="24">联系人qq</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="contact_qq" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>

                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="6" [nzXs]="24">联系人邮箱</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="contact_email" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>

                                    </form>
                                </div>

                            </div>
                        </div>

                    </div>
                </mat-card>


                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">出行人详细信息（选填）</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div fxLayout="column" fxLayoutAlign="start stretch" style="padding:10px 10px" fxLayoutGap="10px">
                                <div fxLayout="column" fxLayoutGap="5px">
                                    <p style="color: red;margin-left: 29%;margin-top: 2px;height: 10px;font-size: 14px;">儿童标准信息：年龄：{{detailModel?.child_age_min}}-{{detailModel?.children_age}}岁<span *ngIf="detailModel?.child_height_max!=0">，身高：{{detailModel?.child_height_min}}-{{detailModel?.child_height_max}}cm</span></p>
                                </div>

                                <div>
                                    <form nz-form [formGroup]="informationForm">
                                        <div style="border: 1px dashed darkgrey; margin-top: 10px;border-radius: 14px;">
                                            <div nz-row style="margin-top: 14px;" *ngIf="numIsShow">
                                                <div style="margin-left: 14px;">
                                                    <button nz-button class="add-button" (click)="addHuman()"><i nz-icon nzType="plus"></i>  添加出行人详细信息</button>
                                                </div>
                                            </div>

                                            <div formArrayName="humanList" *ngFor="let human of humanArray.controls as FormArray;let i = index" style="margin-bottom:10px;margin-top: 10px;">
                                                <div [formGroupName]="i" nz-row>
                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="name">姓名</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <input nz-input formControlName="name" />
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="eng_name">英文名</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <input nz-input formControlName="eng_name" />
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="is_kid">类型</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <nz-select nzPlaceHolder="请选择" formControlName="is_kid">
                                                                    <nz-option [nzLabel]="'成人'" [nzValue]="0"></nz-option>
                                                                    <nz-option [nzLabel]="'儿童'" [nzValue]="1"></nz-option>
                                                                    <nz-option [nzLabel]="'婴儿'" [nzValue]="2"></nz-option>
                                                                </nz-select>
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="gender">性别</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <nz-select nzPlaceHolder="请选择" formControlName="gender">
                                                                    <nz-option [nzLabel]="'男'" [nzValue]="1"></nz-option>
                                                                    <nz-option [nzLabel]="'女'" [nzValue]="2"></nz-option>
                                                                </nz-select>
                                                            </nz-form-control>
                                                            <button nz-button nzType="dashed" class="add-button" (click)="removeIcon(i)">
                                                        <i nz-icon nzType="minus"></i>
                                                        删除
                                                    </button>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="phone">电话</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <input nz-input formControlName="phone" />
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>



                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="id_type">证件类型</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <nz-select nzPlaceHolder="请选择" nzAllowClear formControlName="id_type" (ngModelChange)="changeType($event,i)">
                                                                    <nz-option [nzLabel]="'身份证'" [nzValue]="1"></nz-option>
                                                                    <nz-option [nzLabel]="'护照'" [nzValue]="2"></nz-option>
                                                                    <nz-option [nzLabel]="'回乡证'" [nzValue]="3"></nz-option>
                                                                </nz-select>
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="id_num">证件号码</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <input nz-input formControlName="id_num" />
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24" *ngIf="isChangeData[i] === true">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="birthday">出生年月日</nz-form-label>
                                                            <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                                <nz-date-picker style="width: 100%;" formControlName="birthday"></nz-date-picker>
                                                            </nz-form-control>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                        <div nz-row>
                                                            <button nz-button nzType="primary" (click)="setContract(human)">设为联系人</button>
                                                        </div>
                                                    </nz-form-item>

                                                    <nz-form-item nz-col [nzSm]="14" [nzXs]="24">
                                                        <div nz-row>
                                                            <nz-form-label [nzSm]="3" [nzXs]="24">上传证件照</nz-form-label>
                                                            <div *ngIf="newImgArr[i]?.length!=0" fxLayout="row" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                                                <div *ngFor="let img of newImgArr[i],let index=index" style="position: relative;">
                                                                    <a href={{img}} target="_blank" title="点击可预览"> <img src={{img}} style="width: 50px;height: 50px;"></a>
                                                                    <span (click)="deleteImg(i,index)" style="position: absolute;left: 39px;top: -2px;color: red;color: red;font-weight: bolder; cursor: pointer;">X</span>
                                                                </div>
                                                            </div>
                                                            <button nz-button [disabled]="newImgArr[i]?.length > 1" nzType="primary" (click)="choiceImg(i)">选择图片(只能上传两张)</button>
                                                        </div>
                                                    </nz-form-item>


                                                </div>
                                            </div>

                                        </div>


                                        <div nz-row style="margin-top: 10px;">
                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="emergency_contact_person">紧急联系人姓名</nz-form-label>
                                                    <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                        <input nz-input formControlName="emergency_contact_person" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>
                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="emergency_contact_number">紧急联系人电话</nz-form-label>
                                                    <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                        <input nz-input formControlName="emergency_contact_number" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>
                                            <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                                <div nz-row>
                                                    <nz-form-label [nzSm]="7" [nzXs]="24" nzFor="customer_remarks">客人需求备注</nz-form-label>
                                                    <nz-form-control [nzSm]="12 " [nzXs]="24">
                                                        <input nz-input formControlName="customer_remarks" />
                                                    </nz-form-control>
                                                </div>
                                            </nz-form-item>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-card>

                <mat-card>
                    <div>
                        <div fxLayout="column" fxLayoutAlign="start stretch">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    <h4 style="padding-left: 10px;padding-top: 10px;">计调信息</h4>
                                </div>
                            </div>
                            <nz-divider></nz-divider>
                            <div style="padding:10px 10px" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="10px">
                                <div>
                                    <form nz-form nz-row [formGroup]="contactForm">
                                        <nz-form-item nz-col [nzSm]="6" [nzXs]="24">
                                            <div nz-row>
                                                <nz-form-label [nzSm]="7" [nzXs]="24">内部备注</nz-form-label>
                                                <nz-form-control [nzSm]="12" [nzXs]="24">
                                                    <input nz-input formControlName="internal_remarks" />
                                                </nz-form-control>
                                            </div>
                                        </nz-form-item>
                                    </form>
                                </div>

                            </div>


                        </div>

                    </div>
                </mat-card>


                <mat-card>
                    <div fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="20px" style="padding:10px 10px">
                        <div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign="start stretch" style="font-size: 16px;font-weight: bold;letter-spacing: 1px;">
                            <div *ngIf="isShowFeeDetail===true">
                                共<span style="color: red;">￥{{totalPrice}}元</span>：
                                <span>套餐{{isPackAll}}元| </span>
                                <span>优惠{{discountPrice}}元 </span>
                                <span>附加收费{{other_price}}元 </span>
                            </div>
                            <div><a (click)="feeDetail()" *ngIf="isShowFeeDetail===true">费用明细</a></div>
                        </div>
                        <div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign="center center">
                            <button nz-button nzType="primary" [nzLoading]="isLoadingAdd" style="letter-spacing: 2px; margin-bottom: 9px;" (click)="add()">提交</button>
                        </div>
                    </div>

                </mat-card>



            </div>

        </div>



    </div>
</div>